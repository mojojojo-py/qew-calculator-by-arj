<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>90K Ultra Run Calculator</title>
  <style>
    :root{--p:#2563eb;--s:#10b981;--g:#6b7280;--d:#ef4444}
    body{font-family:Segoe UI,sans-serif;background:#f3f4f6;margin:0;padding:20px;color:#1f2937;position:relative}
    .c{max-width:900px;margin:auto;background:#fff;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,.1);overflow:hidden;position:relative}
    header{background:var(--p);color:#fff;padding:1.5rem;text-align:center;position:relative}
    h1{margin:0;font-size:1.8rem}
    .i{font-size:.9rem;opacity:.9;margin-top:.5rem}
    .n{padding:2rem}
    .g{margin-bottom:1rem}
    label{display:block;margin-bottom:.5rem;font-weight:600;color:var(--g)}
    input{width:100%;max-width:200px;padding:.75rem;border:1px solid #d1d5db;border-radius:8px;font-size:1rem;box-sizing:border-box}
    input.e{border-color:var(--d)}
    button{background:var(--p);color:#fff;border:none;padding:.75rem 1.5rem;border-radius:8px;font-size:1rem;cursor:pointer;margin-top:1rem;width:100%}
    button:hover{background:#1d4ed8}
    table{width:100%;border-collapse:collapse;margin-top:1.5rem;font-size:.95rem}
    th{background:#f8fafc;padding:1rem;text-align:left;border-bottom:2px solid #e5e7eb;color:var(--g)}
    td{padding:1rem;border-bottom:1px solid #e5e7eb}
    tr:hover{background:#f8fafc}
    .h{font-weight:bold;color:var(--s)}
    .t{background:#ecfdf5;font-weight:bold}
    .o{font-size:.85rem;color:var(--g);margin-top:1rem}
    .lang-switch{position:absolute;top:10px;right:10px;font-size:0.9rem;z-index:10}
    .lang-switch a{color:#fff;text-decoration:underline;cursor:pointer;margin:0 5px;font-weight:600}
    .lang-switch a.active{color:#fbbf24}
    @media(max-width:600px){.n{padding:1rem}td,th{padding:.5rem} input{max-width:150px} .lang-switch{top:5px;right:5px;font-size:0.8rem}}
  </style>
</head>
<body>

<div class="c">
  <!-- SWITCH BAHASA -->
  <div class="lang-switch">
    <span data-lang="ina" class="lang-link active" onclick="setLang('ina')">INA</span> |
    <span data-lang="eng" class="lang-link" onclick="setLang('eng')">ENG</span>
  </div>

  <header>
    <h1 data-ina="90K Ultra Run Calculator" data-eng="90K Ultra Run Calculator">90K Ultra Run Calculator</h1>
    <div class="i" data-ina="Estimasi Waktu Pelari by ARJ (21Runners Qatar)" data-eng="Runner Time Estimator by ARJ (21Runners Qatar)">
      Estimasi Waktu Pelari by ARJ (21Runners Qatar)
    </div>
  </header>

  <div class="n">
    <div class="g">
      <label data-ina="Waktu Mulai (HH:MM)" data-eng="Start Time (HH:MM)">Waktu Mulai (HH:MM)</label>
      <input id="s" value="05:00" placeholder="05:00">
    </div>
    <div class="g">
      <label data-ina="Pelari & Data Pace (mm:ss)" data-eng="Runner & Data Pace (mm:ss)">Pelari & Data Pace (mm:ss)</label>
      <div id="r"></div>
    </div>
    <button onclick="calculate()" data-ina="Hitung Estimasi Waktu" data-eng="Calculate Estimated Time">
      Hitung Estimasi Waktu
    </button>
    <div class="o" data-ina="Contoh: <code>5:30</code>" data-eng="Example: <code>5:30</code>">
      Contoh: <code>5:30</code>
    </div>
    <div class="o" style="color:#dc2626;font-weight:600" data-ina="Sumber code: oleh ARJ" data-eng="Source code: by ARJ">
      Sumber kode: oleh ARJ
    </div>
    <div id="x"></div>
  </div>
</div>

<script>
// === DATA JARAK & PELARI ===
const distances = [10.7, 22.5, 14.9, 14.3, 14.6, 13];
const runnersINA = ["Pelari 1", "Pelari 2", "Pelari 3", "Pelari 4", "Pelari 5", "Pelari 6"];
const runnersENG = ["Runner 1", "Runner 2", "Runner 3", "Runner 4", "Runner 5", "Runner 6"];
let currentLang = 'ina';

// === INISIALISASI INPUT PELARI ===
function initRunners() {
  const container = document.getElementById("r");
  container.innerHTML = '';
  const runners = currentLang === 'ina' ? runnersINA : runnersENG;
  const unit = currentLang === 'ina' ? 'menit:detik/km' : 'min:sec/km';
  runners.forEach((name, i) => {
    const div = document.createElement("div");
    div.style.marginBottom = "1rem";
    div.innerHTML = `
      <label>${name} - Leg ${i+1} (${distances[i]} km)</label>
      <input id="p${i}" placeholder="5:30" class="pi" inputmode="numeric" style="display:inline-block;width:48%;margin-right:4%">
      <input type="text" value="${unit}" disabled style="display:inline-block;width:48%;background:#f3f4f6;font-size:.

9rem">
    `;
    container.appendChild(div);
  });
}

// === GANTI BAHASA ===
function setLang(lang) {
  if (lang === currentLang) return;
  currentLang = lang;

  document.querySelectorAll('[data-ina]').forEach(el => {
    el.textContent = el.getAttribute(`data-${lang}`);
  });
  document.querySelectorAll('[data-eng]').forEach(el => {
    if (!el.getAttribute('data-ina')) el.textContent = el.getAttribute(`data-${lang}`);
  });

  document.querySelectorAll('.lang-link').forEach(link => {
    link.classList.toggle('active', link.getAttribute('data-lang') === lang);
  });

  initRunners();
}

// === PARSING & PERHITUNGAN ===
function parsePace(t) {
  const match = t.trim().match(/^(\d+):(\d{2})$/);
  if (!match) return null;
  const m = parseInt(match[1], 10), s = parseInt(match[2], 10);
  return s >= 60 || m < 0 ? null : m + s/60;
}

function calculate() {
  document.querySelectorAll('.pi').forEach(i => i.classList.remove('e'));
  const startInput = document.getElementById("s").value.trim();
  if (!/^(\d{1,2}):(\d{2})$/.test(startInput)) {
    alert(currentLang === 'ina' ? "Format HH:MM salah! Gunakan 05:00" : "Invalid HH:MM format! Use 05:00");
    return;
  }
  const [sh, sm] = startInput.split(":").map(Number);
  let currentMinutes = sh * 60 + sm;
  let html = `<table><tr><th>${currentLang==='ina'?'Pelari':'Runner'}</th><th>${currentLang==='ina'?'Jarak':'Distance'}</th><th>Pace</th><th>${currentLang==='ina'?'Durasi':'Duration'}</th><th>${currentLang==='ina'?'Mulai':'Start'}</th><th>${currentLang==='ina'?'Selesai':'Finish'}</th></tr>`;
  let totalMinutes = 0;
  let valid = true;

  for (let i = 0; i < 6; i++) {
    const paceInput = document.getElementById(`p${i}`).value.trim();
    const pace = parsePace(paceInput);
    if (!pace) {
      document.getElementById(`p${i}`).classList.add('e');
      valid = false;
      continue;
    }
    const dist = distances[i];
    const duration = pace * dist;
    totalMinutes += duration;
    const start = currentMinutes;
    const finish = start + duration;
    html += `<tr><td>${currentLang==='ina'?runnersINA[i]:runnersENG[i]}</td><td>${dist} km</td><td>${paceInput}/km</td><td>${formatDuration(duration)}</td><td>${formatTime(start)}</td><td class="h">${formatTime(finish)}</td></tr>`;
    currentMinutes = finish;
  }

  if (!valid) {
    alert(currentLang === 'ina' ? "Beberapa pace salah! Gunakan mm:ss" : "Some pace invalid! Use mm:ss");
    return;
  }

  const totalHours = Math.floor(totalMinutes / 60);
  const totalMins = Math.round(totalMinutes % 60);
  const finalTime = formatTime(sh * 60 + sm + totalMinutes);
  const hourLabel = currentLang === 'ina' ? 'j' : 'h';
  const minLabel = currentLang === 'ina' ? 'm' : 'm'; // sama
  html += `<tr class="t"><td colspan="3"><strong>Total: ${distances.reduce((a,b)=>a+b,0)} km</strong></td><td><strong>${totalHours}${hourLabel} ${totalMins}m</strong></td><td colspan="2"><strong>${currentLang==='ina'?'Selesai':'Finish'}: ${finalTime}</strong></td></tr></table>`;
  document.getElementById("x").innerHTML = html;
}

function formatTime(minutes) {
  const total = minutes % (24 * 60);
  const h = Math.floor(total / 60).toString().padStart(2, '0');
  const m = Math.floor(total % 60).toString().padStart(2, '0');
  return `${h}:${m}`;
}

function formatDuration(minutes) {
  const h = Math.floor(minutes / 60);
  const m = Math.floor(minutes % 60);
  const hourLabel = currentLang === 'ina' ? 'j' : 'h';
  const minLabel = currentLang === 'ina' ? 'menit' : 'min';
  return h > 0 ? `${h}${hourLabel} ${m}m` : `${m} ${minLabel}`;
}

// === INPUT FORMATTER (mm:ss) ===
document.getElementById("r").addEventListener('input', e => {
  if (!e.target.classList.contains('pi')) return;
  let val = e.target.value.replace(/\D/g, '');
  if (val.length > 4) val = val.slice(0, 4);
  if (val.length >= 3) val = val.slice(0, -2) + ':' + val.slice(-2);
  e.target.value = val;
});

// === INISIALISASI ===
initRunners();
</script>

</body>
</html>

